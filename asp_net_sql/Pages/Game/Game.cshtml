@page

@using asp_net_sql.Pages.CodeBehind

@model Game_CB

<script type="module">
    const get = id => document.getElementById(id);

    for (let i = 0; i < 9; i++) {
        const cell = get('cell_' + i);
        cell.addEventListener('click', () => {
            console.log(`cell_${i} clicked`);
        });
    }
</script>

<div class="main_container">
    <div class="header">1</div>
    <div class="left">
        @await Html.PartialAsync("_InfoPartial")
        <div id="APILog"><>
    </div>
    <div class="middle">
        <div class="aspect game_container">
            <div class="cell" id="cell_0">1</div>
            <div class="cell" id="cell_1">2</div>
            <div class="cell" id="cell_2">3</div>
            <div class="cell" id="cell_3">4</div>
            <div class="cell" id="cell_4">5</div>
            <div class="cell" id="cell_5">6</div>
            <div class="cell" id="cell_6">7</div>
            <div class="cell" id="cell_7">8</div>
            <div class="cell" id="cell_8">9</div>
        </div>
    </div>
    <div class="right">4</div>
    <div class="footer">5</div>
</div>

<script type="module">

    // promise wrapper for XMLHttpRequest
    import { makeRequest } from '/js/network.js'

    const get = id => document.getElementById(id);

    const APILog = get('APILog');

    const url = '@ViewData["baseURI"]';

    const POST_API = (data, endpoint = '/API/Index') => {

        const jsonData = JSON.stringify(data);

        makeRequest(url + endpoint, '', 'POST', 0, null, jsonData)
            .then(res => { console.log(res) })
            .catch(err => { console.error(err) });
    };

    window.addEventListener('load', () => { 
        POST_API({ command: 'StartEngine' });
    });

</script>
